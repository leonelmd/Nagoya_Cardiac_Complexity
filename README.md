# Nagoya Cardiac Complexity Analysis - Public Release

This repository contains the  analysis scripts, and results for the study investigating cardiac complexity biomarkers in Parkinson's Disease (PD) using 24-hour ECG monitoring from the Nagoya University Cohort.

## ðŸ“‚ Repository Structure

The project is organized into four main directories:

### 1. `data/`
**Available upon reasonable request and after aproval of our Nagoya University collaborators.**
Raw input data and metadata required to reproduce the analysis.
- **`processed_rri/`**: Contains the processed R-R interval time series for each subject (after artifact removal).
- **`metadata/metadata.csv`**: Clinical and demographic information (ID, Group, Age, Sex, Recording Duration).
- **`cetram_comparison/`**: Reference values from the external CETRAM cohort (Chile) used for validation.

### 2. `scripts/`
The complete computational pipeline, numbered sequentially for reproducibility.
- **`pipeline_step1_calculate_metrics.jl`**: High-performance Julia script that computes multiscale entropy (MSE) and HRV metrics on 30-minute sliding windows across the 24h recordings.
- **`pipeline_step2_fig1.py`**: Generates **Figure 1**, visualizing the 24h individual R-R interval trends and the group-level heart rate distribution.
- **`pipeline_step3_fig2.py`**: Generates **Figure 2**, displaying the 24h evolution of complexity and comparing Day vs. Night Multiscale Entropy curves.
- **`pipeline_step4_fig3.py`**: Generates **Figure 3**, a cross-cultural comparison of heart-rate normalized complexity between the Nagoya (Japan) and CETRAM (Chile) cohorts.
- **`pipeline_step5_fig4.py`**: Generates **Figure 4**, an exploratory analysis of the relationship between Age and Complexity, including regression statistics.
- **`pipeline_step6_supplementary_dashboard.py`**: Produces a comprehensive dashboard of all HRV metrics and generates statistical summary tables.

### 3. `calculations/`
Intermediate output files generated by the analysis pipeline.
- **`Full_HRV_Evolution_1min.csv`**: The master dataset containing minute-by-minute HRV and complexity metrics for all 24h recordings.
- **`MSE_curves_Day.csv` / `MSE_curves_Night.csv`**: Aggregated Multiscale Entropy curves for daytime (10:00-16:00) and nighttime (00:00-06:00) periods.
- **`Day_Window_Stats.csv` / `Night_Window_Stats.csv`**: Statistical summaries for complexity metrics in specific time windows.

### 4. `figures/`
Figures in SVG format.
- **`Figure1/`**: 24h R-R Interval Trends & Heart Rate Distribution.
- **`Figure2/`**: Complexity Evaluation (24h Evolution, MSE Curves, Boxplots).
- **`Figure3/`**: Multi-cohort Validation (Japan vs. Chile).
- **`Figure4/`**: Age Analysis (Correlation and Regression).
- **`Supplementary/`**: Detailed dashboards and additional statistical tables.

---

## ðŸš€ How to Run

1.  **Prerequisites**:
    -   Python 3.8+ (Required libraries: `pandas`, `numpy`, `matplotlib`, `seaborn`, `scipy`)
    -   Julia 1.6+ (Required packages: `CSV`, `DataFrames`, `Statistics`, `EntropyHub` or equivalent complexity libraries)

2.  **Reproduction Steps**:
    -   **Step 1**: Run the Julia script to process raw R-R intervals and generate the evolution calculations.
        ```bash
        julia scripts/pipeline_step1_calculate_metrics.jl
        ```
    -   **Step 2-5**: Run the Python scripts to generate figures.
        ```bash
        python3 scripts/pipeline_step2_fig1.py
        python3 scripts/pipeline_step3_fig2.py
        python3 scripts/pipeline_step4_fig3.py
        python3 scripts/pipeline_step5_fig4.py
        python3 scripts/pipeline_step6_supplementary_dashboard.py
        ```

3.  **Outputs**:
    -   Figures will be saved to the respective `figures/` subdirectories.
    -   Statistical summaries will be available in `figures/Supplementary/`.

## Authors
Developed by the NeuroEng@Usach group, Univesidad de Santiago de Chile, after the data shared by our collaborators at University of Nagoya, Japan

## ðŸ“„ License
This dataset and code are released under the MIT License. Please cite the accompanying publication when using this resource.
